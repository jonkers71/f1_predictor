2025-05-04 19:45:24,189 - Main - INFO - Starting F1 ML Project from root: /home/ubuntu/f1_predictor
2025-05-04 19:45:24,195 - MenuUtils - INFO - Successfully loaded driver map from /home/ubuntu/f1_predictor/data/processed/driver_map.csv. 53 drivers found.
2025-05-04 19:46:06,688 - Main - ERROR - Unexpected error in main: 
Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/main.py", line 21, in main
    display_main_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/main_menu.py", line 39, in display_main_menu
    choice = input("Select an option (1–7): ").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
EOFError
2025-05-04 19:49:11,573 - Main - INFO - Starting F1 ML Project from root: /home/ubuntu/f1_predictor
2025-05-04 19:49:11,577 - MenuUtils - INFO - Successfully loaded driver map from /home/ubuntu/f1_predictor/data/processed/driver_map.csv. 53 drivers found.
2025-05-04 19:49:51,854 - RacePredictor - INFO - --- Starting Upcoming Race Prediction ---
2025-05-04 19:49:51,854 - RacePredictor - ERROR - Error loading prediction asset: [Errno 2] No such file or directory: '/home/ubuntu/f1_predictor/models/race_predictor/race_predictor_model.joblib'. Model or supporting files not found. Please train the race predictor model first.
2025-05-04 19:50:03,569 - Main - ERROR - Unexpected error in main: 
Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/main.py", line 21, in main
    display_main_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/main_menu.py", line 40, in display_main_menu
    choice = input("Select an option (1–7): ").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
EOFError
2025-05-04 19:50:53,927 - Main - INFO - Starting F1 ML Project from root: /home/ubuntu/f1_predictor
2025-05-04 19:50:53,931 - MenuUtils - INFO - Successfully loaded driver map from /home/ubuntu/f1_predictor/data/processed/driver_map.csv. 53 drivers found.
2025-05-04 19:51:28,746 - DataMenu - INFO - User entered Model Training Menu
2025-05-04 19:51:36,274 - DataMenu - INFO - Attempting to run script: /home/ubuntu/f1_predictor/model_training/race_predictor_trainer.py from /home/ubuntu/f1_predictor
2025-05-04 19:51:37,617 - RacePredictorTrainer - INFO - Starting Race Predictor Training Pipeline...
2025-05-04 19:51:37,618 - RacePredictorTrainer - INFO - Loading data from /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv
2025-05-04 19:51:38,918 - RacePredictorTrainer - INFO - Loaded 135551 rows.
2025-05-04 19:51:38,918 - RacePredictorTrainer - INFO - Engineering pre-race features...
2025-05-04 19:51:39,128 - DataMenu - ERROR - Script model_training/race_predictor_trainer.py failed with return code 1
2025-05-04 19:54:53,334 - Main - ERROR - Unexpected error in main: 
Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/main.py", line 21, in main
    display_main_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/main_menu.py", line 56, in display_main_menu
    model_training_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/data_menu.py", line 89, in model_training_menu
    choice = input("Select an option (1-3): ").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
EOFError
2025-05-04 19:55:25,924 - Main - INFO - Starting F1 ML Project from root: /home/ubuntu/f1_predictor
2025-05-04 19:55:25,928 - MenuUtils - INFO - Successfully loaded driver map from /home/ubuntu/f1_predictor/data/processed/driver_map.csv. 53 drivers found.
2025-05-04 19:56:04,711 - DataMenu - INFO - User entered Model Training Menu
2025-05-04 19:56:10,901 - DataMenu - INFO - Attempting to run script: /home/ubuntu/f1_predictor/model_training/race_predictor_trainer.py from /home/ubuntu/f1_predictor
2025-05-04 19:56:12,097 - RacePredictorTrainer - INFO - Starting Race Predictor Training Pipeline...
2025-05-04 19:56:12,097 - RacePredictorTrainer - INFO - Loading data from /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv
2025-05-04 19:56:13,561 - RacePredictorTrainer - INFO - Loaded 135551 rows.
2025-05-04 19:56:13,562 - RacePredictorTrainer - INFO - Engineering pre-race features...
2025-05-04 19:56:13,695 - RacePredictorTrainer - INFO - Engineered 'quali_pos' feature.
2025-05-04 19:56:13,817 - RacePredictorTrainer - INFO - Engineered 'avg_practice_lap_time' feature.
2025-05-04 19:56:13,836 - RacePredictorTrainer - WARNING - Could not engineer 'sprint_pos'. Sprint race data or race_position missing.
2025-05-04 19:56:13,843 - RacePredictorTrainer - INFO - Finished engineering pre-race features.
2025-05-04 19:56:13,891 - RacePredictorTrainer - INFO - Filtered for race sessions. Rows remaining: 54178
2025-05-04 19:56:14,170 - DataMenu - ERROR - Script model_training/race_predictor_trainer.py failed with return code 1
2025-05-04 20:00:30,380 - Main - ERROR - Unexpected error in main: 
Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/main.py", line 21, in main
    display_main_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/main_menu.py", line 56, in display_main_menu
    model_training_menu(project_root)
  File "/home/ubuntu/f1_predictor/menu/data_menu.py", line 89, in model_training_menu
    choice = input("Select an option (1-3): ").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
EOFError
2025-05-04 20:02:43,356 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-04 20:02:43,356 - DatasetBuilder - INFO - Loading lap data from /home/ubuntu/f1_predictor/data/raw/lap_data.csv
2025-05-04 20:02:44,200 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-04 20:02:44,200 - DatasetBuilder - INFO - Loading session data from /home/ubuntu/f1_predictor/data/raw/session_raw.csv
2025-05-04 20:02:44,203 - DatasetBuilder - ERROR - Error loading session data: 'date_start'
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'date_start'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/data_pipeline/dataset_builder.py", line 444, in main
    session_data["year"] = pd.to_datetime(session_data["date_start"], errors="coerce").dt.year
                                          ~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'date_start'
2025-05-04 20:04:13,278 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-04 20:04:13,278 - DatasetBuilder - INFO - Loading lap data from /home/ubuntu/f1_predictor/data/raw/lap_data.csv
2025-05-04 20:04:14,031 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-04 20:04:14,031 - DatasetBuilder - INFO - Loading session data from /home/ubuntu/f1_predictor/data/raw/session_raw.csv
2025-05-04 20:04:14,034 - DatasetBuilder - WARNING - Using 'date' column to extract year as 'date_start' is missing.
2025-05-04 20:04:14,039 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-04 20:04:14,039 - DatasetBuilder - INFO - Loading weather data from /home/ubuntu/f1_predictor/data/raw/weather_raw.csv
2025-05-04 20:04:14,042 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-04 20:04:14,042 - DatasetBuilder - INFO - Loading Ergast results data from /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv
2025-05-04 20:04:14,042 - DatasetBuilder - WARNING - Ergast results file not found: /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv. Race positions will be missing.
2025-05-04 20:04:14,042 - DatasetBuilder - INFO - Starting data merging...
2025-05-04 20:04:14,043 - DatasetBuilder - WARNING - Using "date" column from session data as "date_start" is missing.
2025-05-04 20:04:14,043 - DatasetBuilder - ERROR - Missing required columns in session_data: ['circuit_short_name']. Cannot proceed.
2025-05-04 20:04:14,043 - DatasetBuilder - ERROR - Merging failed or resulted in empty dataframe. Exiting.
2025-05-04 20:08:19,287 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-04 20:08:19,288 - DatasetBuilder - INFO - Loading lap data from /home/ubuntu/f1_predictor/data/raw/lap_data.csv
2025-05-04 20:08:19,985 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-04 20:08:19,985 - DatasetBuilder - INFO - Loading session data from /home/ubuntu/f1_predictor/data/raw/session_raw.csv
2025-05-04 20:08:19,988 - DatasetBuilder - WARNING - Using 'date' column to extract year as 'date_start' is missing.
2025-05-04 20:08:19,992 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-04 20:08:19,993 - DatasetBuilder - INFO - Loading weather data from /home/ubuntu/f1_predictor/data/raw/weather_raw.csv
2025-05-04 20:08:19,996 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-04 20:08:19,996 - DatasetBuilder - INFO - Loading Ergast results data from /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv
2025-05-04 20:08:19,996 - DatasetBuilder - WARNING - Ergast results file not found: /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv. Race positions will be missing.
2025-05-04 20:08:19,996 - DatasetBuilder - INFO - Starting data merging...
2025-05-04 20:08:19,996 - DatasetBuilder - WARNING - Using "date" column from session data as "date_start" is missing.
2025-05-04 20:08:19,997 - DatasetBuilder - WARNING - Column "circuit_short_name" missing in session_data. Adding placeholder based on country.
2025-05-04 20:08:19,998 - DatasetBuilder - INFO - Merging lap_data with session_data on "session_key"...
2025-05-04 20:08:20,033 - DatasetBuilder - INFO - Rows after merging laps and sessions: 143634
2025-05-04 20:08:20,033 - DatasetBuilder - INFO - Merging with weather_data on "meeting_key"...
2025-05-04 20:08:20,035 - DatasetBuilder - ERROR - Error merging with weather_data: 'meeting_key'
Traceback (most recent call last):
  File "/home/ubuntu/f1_predictor/data_pipeline/dataset_builder.py", line 310, in merge_data
    merged_data = pd.merge(merged_data, weather_data_unique, on="meeting_key", how="left", suffixes=("", "_weather"))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/reshape/merge.py", line 170, in merge
    op = _MergeOperation(
         ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/reshape/merge.py", line 794, in __init__
    ) = self._get_merge_keys()
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/reshape/merge.py", line 1310, in _get_merge_keys
    left_keys.append(left._get_label_or_level_values(lk))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/pandas/core/generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'meeting_key'
2025-05-04 20:09:32,969 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-04 20:09:32,969 - DatasetBuilder - INFO - Loading lap data from /home/ubuntu/f1_predictor/data/raw/lap_data.csv
2025-05-04 20:09:33,729 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-04 20:09:33,729 - DatasetBuilder - INFO - Loading session data from /home/ubuntu/f1_predictor/data/raw/session_raw.csv
2025-05-04 20:09:33,732 - DatasetBuilder - WARNING - Using 'date' column to extract year as 'date_start' is missing.
2025-05-04 20:09:33,737 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-04 20:09:33,737 - DatasetBuilder - INFO - Loading weather data from /home/ubuntu/f1_predictor/data/raw/weather_raw.csv
2025-05-04 20:09:33,740 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-04 20:09:33,740 - DatasetBuilder - INFO - Loading Ergast results data from /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv
2025-05-04 20:09:33,741 - DatasetBuilder - WARNING - Ergast results file not found: /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv. Race positions will be missing.
2025-05-04 20:09:33,741 - DatasetBuilder - INFO - Starting data merging...
2025-05-04 20:09:33,741 - DatasetBuilder - WARNING - Using "date" column from session data as "date_start" is missing.
2025-05-04 20:09:33,741 - DatasetBuilder - WARNING - Column "circuit_short_name" missing in session_data. Adding placeholder based on country.
2025-05-04 20:09:33,743 - DatasetBuilder - INFO - Merging lap_data with session_data on "session_key"...
2025-05-04 20:09:33,777 - DatasetBuilder - INFO - Rows after merging laps and sessions: 143634
2025-05-04 20:09:33,778 - DatasetBuilder - ERROR - Column "meeting_key" missing in merged lap/session data. Cannot merge weather.
2025-05-04 20:09:33,782 - DatasetBuilder - WARNING - Ergast results data is empty or None. Skipping race results merge.
2025-05-04 20:09:33,848 - DatasetBuilder - INFO - Inferred/updated "session_type" from "session_name".
2025-05-04 20:09:33,848 - DatasetBuilder - INFO - Data merging complete.
2025-05-04 20:09:34,192 - DatasetBuilder - INFO - Added "year" and "race_weekend" columns.
2025-05-04 20:09:34,192 - DatasetBuilder - INFO - Adding rolling lap time features with window size 3...
2025-05-04 20:09:34,276 - DatasetBuilder - INFO - Calculated rolling_avg_lap_time_3. Filled NaNs with 96.388.
2025-05-04 20:09:34,282 - DatasetBuilder - INFO - Starting cleaning. Initial rows: 143634
2025-05-04 20:09:34,282 - DatasetBuilder - INFO - Inferring/updating "session_type" from "session_name" during cleaning.
2025-05-04 20:09:34,380 - DatasetBuilder - INFO - Rows after filtering session types (['practice', 'qualifying', 'race', 'sprint', 'sprint_qualifying']): 138430
2025-05-04 20:09:34,442 - DatasetBuilder - INFO - Filtered out 6971 rows with invalid lap_duration (<= 0). Rows remaining: 131459
2025-05-04 20:09:34,445 - DatasetBuilder - WARNING - Median and Mean for air_temperature are NaN, filling with 0.
2025-05-04 20:09:34,447 - DatasetBuilder - WARNING - Median and Mean for humidity are NaN, filling with 0.
2025-05-04 20:09:34,449 - DatasetBuilder - WARNING - Median and Mean for pressure are NaN, filling with 0.
2025-05-04 20:09:34,450 - DatasetBuilder - WARNING - Median and Mean for rainfall are NaN, filling with 0.
2025-05-04 20:09:34,452 - DatasetBuilder - WARNING - Median and Mean for track_temperature are NaN, filling with 0.
2025-05-04 20:09:34,454 - DatasetBuilder - WARNING - Median and Mean for wind_direction are NaN, filling with 0.
2025-05-04 20:09:34,455 - DatasetBuilder - WARNING - Median and Mean for wind_speed are NaN, filling with 0.
2025-05-04 20:09:34,508 - DatasetBuilder - INFO - Filled NaN values using median/mean for numeric or default for others.
2025-05-04 20:09:34,602 - DatasetBuilder - WARNING - Still missing values after cleaning: 8
2025-05-04 20:09:34,786 - DatasetBuilder - WARNING - Columns with remaining NaNs:
date_start    8
dtype: int64
2025-05-04 20:09:34,786 - DatasetBuilder - INFO - Cleaning complete. Final rows: 131459
2025-05-04 20:09:34,787 - DatasetBuilder - INFO - Saving cleaned data to /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv...
2025-05-04 20:09:39,135 - DatasetBuilder - INFO - Successfully saved 131459 rows to /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv.
2025-05-04 20:09:39,135 - DatasetBuilder - INFO - Generating summary report to /home/ubuntu/f1_predictor/data/processed/summary.txt...
2025-05-04 20:09:39,438 - DatasetBuilder - INFO - Summary report generated successfully.
2025-05-04 20:09:39,438 - DatasetBuilder - INFO - Dataset builder pipeline finished.
2025-05-04 20:37:31,177 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-04 20:37:31,178 - DatasetBuilder - INFO - Loading lap data from /home/ubuntu/f1_predictor/data/raw/lap_data.csv
2025-05-04 20:37:32,364 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-04 20:37:32,364 - DatasetBuilder - INFO - Loading session data from /home/ubuntu/f1_predictor/data/raw/session_raw.csv
2025-05-04 20:37:32,367 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-04 20:37:32,367 - DatasetBuilder - INFO - Loading weather data from /home/ubuntu/f1_predictor/data/raw/weather_raw.csv
2025-05-04 20:37:32,370 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-04 20:37:32,370 - DatasetBuilder - INFO - Loading Ergast results data from /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv
2025-05-04 20:37:32,371 - DatasetBuilder - WARNING - Ergast results file not found: /home/ubuntu/f1_predictor/data/raw/ergast_race_results.csv. Race positions will be missing.
2025-05-04 20:37:32,371 - DatasetBuilder - INFO - Starting data merging...
2025-05-04 20:37:32,371 - DatasetBuilder - WARNING - Using 'date' column from session data as 'date_start' is missing.
2025-05-04 20:37:32,372 - DatasetBuilder - INFO - Extracting 'year' from 'date' in session_data.
2025-05-04 20:37:32,378 - DatasetBuilder - WARNING - Column 'circuit_short_name' missing in session_data. Adding placeholder based on country.
2025-05-04 20:37:32,380 - DatasetBuilder - INFO - Merging lap_data with session_data on 'session_key'...
2025-05-04 20:37:32,420 - DatasetBuilder - INFO - Rows after merging laps and sessions: 143634
2025-05-04 20:37:32,420 - DatasetBuilder - ERROR - CRITICAL: 'meeting_key' was lost during lap/session merge!
2025-05-04 20:37:32,420 - DatasetBuilder - INFO - Attempting to re-merge meeting_key...
2025-05-04 20:37:32,544 - DatasetBuilder - INFO - Merging with weather_data on 'meeting_key'...
2025-05-04 20:37:32,839 - DatasetBuilder - INFO - Rows after merging with weather: 143634
2025-05-04 20:37:32,840 - DatasetBuilder - WARNING - Ergast results data is empty or None. Skipping race results merge. Race positions will be NaN.
2025-05-04 20:37:32,912 - DatasetBuilder - INFO - Inferred/updated 'session_type' from 'session_name'.
2025-05-04 20:37:32,912 - DatasetBuilder - INFO - Data merging complete.
2025-05-04 20:37:33,306 - DatasetBuilder - INFO - Added 'year' and 'race_weekend' columns.
2025-05-04 20:37:33,306 - DatasetBuilder - INFO - Adding rolling lap time features with window size 3...
2025-05-04 20:37:33,386 - DatasetBuilder - INFO - Calculated rolling_avg_lap_time_3. Filled NaNs with 96.388.
2025-05-04 20:37:33,392 - DatasetBuilder - INFO - Starting cleaning. Initial rows: 143634
2025-05-04 20:37:33,532 - DatasetBuilder - INFO - Inferring/updating 'session_type' from 'session_name' during cleaning.
2025-05-04 20:37:33,618 - DatasetBuilder - INFO - Rows after filtering session types (['practice', 'qualifying', 'race', 'sprint', 'sprint_qualifying']): 138430
2025-05-04 20:37:33,651 - DatasetBuilder - INFO - Filtered out 6971 rows with invalid lap_duration (<= 0). Rows remaining: 131459
2025-05-04 20:37:33,705 - DatasetBuilder - INFO - Filled NaN values using median/mean for numeric or default for others.
2025-05-04 20:37:33,794 - DatasetBuilder - WARNING - Still missing values after cleaning: 8
2025-05-04 20:37:33,794 - DatasetBuilder - WARNING - Columns with remaining NaNs:
date_start    8
dtype: int64
2025-05-04 20:37:33,795 - DatasetBuilder - INFO - Cleaning complete. Final rows: 131459
2025-05-04 20:37:33,795 - DatasetBuilder - INFO - Saving cleaned data to /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv...
2025-05-04 20:37:39,067 - DatasetBuilder - INFO - Successfully saved 131459 rows to /home/ubuntu/f1_predictor/data/processed/cleaned_f1_data.csv.
2025-05-04 20:37:39,067 - DatasetBuilder - INFO - Generating summary report to /home/ubuntu/f1_predictor/data/processed/summary.txt...
2025-05-04 20:37:39,438 - DatasetBuilder - INFO - Summary report generated successfully.
2025-05-04 20:37:39,438 - DatasetBuilder - INFO - Dataset builder pipeline finished.
2025-05-05 10:40:53,442 - Main - INFO - Starting F1 ML Project from root: /Users/brendan/Python/f1_ml_project
2025-05-05 10:40:53,446 - MenuUtils - INFO - Successfully loaded driver map from /Users/brendan/Python/f1_ml_project/data/processed/driver_map.csv. 53 drivers found.
2025-05-05 10:41:00,892 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/session_fetcher.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:41:01,033 - SessionFetcher - INFO - --- Starting Session Fetcher for years: [2023, 2024, 2025] ---
2025-05-05 10:41:03,656 - SessionFetcher - INFO - Retrieved 112 session entries for 2023.
2025-05-05 10:41:06,116 - SessionFetcher - INFO - Retrieved 120 session entries for 2024.
2025-05-05 10:41:08,267 - SessionFetcher - INFO - Retrieved 33 session entries for 2025.
2025-05-05 10:41:08,270 - SessionFetcher - INFO - Combined session data saved to /Users/brendan/Python/f1_ml_project/data/raw/session_raw.csv. Total sessions: 265
2025-05-05 10:41:08,270 - SessionFetcher - INFO - Successfully fetched a total of 265 sessions across all years.
2025-05-05 10:41:08,294 - DataMenu - INFO - Script data_pipeline/session_fetcher.py finished successfully. RC: 0
2025-05-05 10:41:45,108 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/lap_collector.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:41:45,241 - LapCollector - INFO - --- Starting Lap Collector (v1.20 - Failed Session Cleanup) --- 
2025-05-05 10:41:47,170 - LapCollector - INFO - Loaded 265 completed session keys from /Users/brendan/Python/f1_ml_project/data/raw/done_sessions.txt
2025-05-05 10:41:47,171 - LapCollector - INFO - Found 265 sessions in /Users/brendan/Python/f1_ml_project/data/raw/session_raw.csv.
2025-05-05 10:41:47,172 - LapCollector - INFO - Total sessions in CSV: 265
2025-05-05 10:41:47,172 - LapCollector - INFO - Sessions already completed: 265
2025-05-05 10:41:47,172 - LapCollector - INFO - Sessions remaining to fetch: 0
2025-05-05 10:41:47,172 - LapCollector - INFO - No new sessions to fetch.
2025-05-05 10:41:47,172 - LapCollector - INFO - --- Lap Collector Finished --- 
2025-05-05 10:41:47,185 - DataMenu - INFO - Script data_pipeline/lap_collector.py finished successfully. RC: 0
2025-05-05 10:41:51,535 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/weather_fetcher.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:41:51,582 - DataMenu - ERROR - Script data_pipeline/weather_fetcher.py failed with return code 1
2025-05-05 10:43:20,546 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/weather_fetcher.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:43:21,066 - WeatherFetcher - INFO - Loaded 265 sessions from /Users/brendan/Python/f1_ml_project/data/raw/session_raw.csv
2025-05-05 10:43:21,071 - WeatherFetcher - INFO - Found 265 existing session keys in /Users/brendan/Python/f1_ml_project/data/raw/weather_raw.csv
2025-05-05 10:43:21,071 - WeatherFetcher - INFO - ✅ No missing weather data to fetch. File is up-to-date.
2025-05-05 10:43:21,108 - DataMenu - INFO - Script data_pipeline/weather_fetcher.py finished successfully. RC: 0
2025-05-05 10:43:28,844 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/dataset_builder.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:43:29,204 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-05 10:43:29,204 - DatasetBuilder - INFO - Loading lap data from /Users/brendan/Python/f1_ml_project/data/raw/lap_data.csv
2025-05-05 10:43:29,443 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-05 10:43:29,443 - DatasetBuilder - INFO - Loading session data from /Users/brendan/Python/f1_ml_project/data/raw/session_raw.csv
2025-05-05 10:43:29,444 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-05 10:43:29,444 - DatasetBuilder - INFO - Loading weather data from /Users/brendan/Python/f1_ml_project/data/raw/weather_raw.csv
2025-05-05 10:43:29,445 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-05 10:43:29,445 - DatasetBuilder - INFO - Loading Ergast results data from /Users/brendan/Python/f1_ml_project/data/raw/ergast_race_results.csv
2025-05-05 10:43:29,445 - DatasetBuilder - WARNING - Ergast results file not found: /Users/brendan/Python/f1_ml_project/data/raw/ergast_race_results.csv. Race positions will be missing.
2025-05-05 10:43:29,445 - DatasetBuilder - INFO - Starting data merging...
2025-05-05 10:43:29,445 - DatasetBuilder - WARNING - Using 'date' column from session data as 'date_start' is missing.
2025-05-05 10:43:29,445 - DatasetBuilder - INFO - Extracting 'year' from 'date' in session_data.
2025-05-05 10:43:29,451 - DatasetBuilder - WARNING - Column 'circuit_short_name' missing in session_data. Adding placeholder based on country.
2025-05-05 10:43:29,452 - DatasetBuilder - INFO - Merging lap_data with session_data on 'session_key'...
2025-05-05 10:43:29,480 - DatasetBuilder - INFO - Rows after merging laps and sessions: 143634
2025-05-05 10:43:29,480 - DatasetBuilder - ERROR - CRITICAL: 'meeting_key' was lost during lap/session merge!
2025-05-05 10:43:29,480 - DatasetBuilder - INFO - Attempting to re-merge meeting_key...
2025-05-05 10:43:29,511 - DatasetBuilder - INFO - Merging with weather_data on 'meeting_key'...
2025-05-05 10:43:29,686 - DatasetBuilder - INFO - Rows after merging with weather: 143634
2025-05-05 10:43:29,687 - DatasetBuilder - WARNING - Ergast results data is empty or None. Skipping race results merge. Race positions will be NaN.
2025-05-05 10:43:29,711 - DatasetBuilder - INFO - Inferred/updated 'session_type' from 'session_name'.
2025-05-05 10:43:29,711 - DatasetBuilder - INFO - Data merging complete.
2025-05-05 10:43:29,827 - DatasetBuilder - INFO - Added 'year' and 'race_weekend' columns.
2025-05-05 10:43:29,828 - DatasetBuilder - INFO - Adding rolling lap time features with window size 3...
2025-05-05 10:43:29,862 - DatasetBuilder - INFO - Calculated rolling_avg_lap_time_3. Filled NaNs with 96.388.
2025-05-05 10:43:29,867 - DatasetBuilder - INFO - Starting cleaning. Initial rows: 143634
2025-05-05 10:43:29,911 - DatasetBuilder - INFO - Inferring/updating 'session_type' from 'session_name' during cleaning.
2025-05-05 10:43:29,951 - DatasetBuilder - INFO - Rows after filtering session types (['practice', 'qualifying', 'race', 'sprint', 'sprint_qualifying']): 138430
2025-05-05 10:43:29,970 - DatasetBuilder - INFO - Filtered out 6971 rows with invalid lap_duration (<= 0). Rows remaining: 131459
2025-05-05 10:43:29,995 - DatasetBuilder - INFO - Filled NaN values using median/mean for numeric or default for others.
2025-05-05 10:43:30,026 - DatasetBuilder - WARNING - Still missing values after cleaning: 8
2025-05-05 10:43:30,026 - DatasetBuilder - WARNING - Columns with remaining NaNs:
date_start    8
dtype: int64
2025-05-05 10:43:30,026 - DatasetBuilder - INFO - Cleaning complete. Final rows: 131459
2025-05-05 10:43:30,026 - DatasetBuilder - INFO - Saving cleaned data to /Users/brendan/Python/f1_ml_project/data/processed/cleaned_f1_data.csv...
2025-05-05 10:43:31,272 - DatasetBuilder - INFO - Successfully saved 131459 rows to /Users/brendan/Python/f1_ml_project/data/processed/cleaned_f1_data.csv.
2025-05-05 10:43:31,272 - DatasetBuilder - INFO - Generating summary report to /Users/brendan/Python/f1_ml_project/data/processed/summary.txt...
2025-05-05 10:43:31,409 - DatasetBuilder - INFO - Summary report generated successfully.
2025-05-05 10:43:31,410 - DatasetBuilder - INFO - Dataset builder pipeline finished.
2025-05-05 10:43:31,473 - DataMenu - INFO - Script data_pipeline/dataset_builder.py finished successfully. RC: 0
2025-05-05 10:49:10,753 - Main - INFO - Starting F1 ML Project from root: /Users/brendan/Python/f1_ml_project
2025-05-05 10:49:10,756 - MenuUtils - INFO - Successfully loaded driver map from /Users/brendan/Python/f1_ml_project/data/processed/driver_map.csv. 53 drivers found.
2025-05-05 10:54:23,972 - Main - INFO - Starting F1 ML Project from root: /Users/brendan/Python/f1_ml_project
2025-05-05 10:54:23,976 - MenuUtils - INFO - Successfully loaded driver map from /Users/brendan/Python/f1_ml_project/data/processed/driver_map.csv. 53 drivers found.
2025-05-05 10:54:37,315 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/ergast_fetcher.py from /Users/brendan/Python/f1_ml_project
2025-05-05 10:56:27,190 - DataMenu - INFO - Script data_pipeline/ergast_fetcher.py finished successfully. RC: 0
2025-05-05 11:30:56,973 - Main - INFO - Starting F1 ML Project from root: /Users/brendan/Python/f1_ml_project
2025-05-05 11:30:56,978 - MenuUtils - INFO - Successfully loaded driver map from /Users/brendan/Python/f1_ml_project/data/processed/driver_map.csv. 53 drivers found.
2025-05-05 11:31:03,311 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/ergast_fetcher.py from /Users/brendan/Python/f1_ml_project
2025-05-05 11:44:12,509 - DataMenu - INFO - Script data_pipeline/ergast_fetcher.py finished successfully. RC: 0
2025-05-05 12:03:57,799 - DataMenu - INFO - Attempting to run script: /Users/brendan/Python/f1_ml_project/data_pipeline/dataset_builder.py from /Users/brendan/Python/f1_ml_project
2025-05-05 12:03:58,427 - DatasetBuilder - INFO - Starting dataset builder pipeline...
2025-05-05 12:03:58,427 - DatasetBuilder - INFO - Loading lap data from /Users/brendan/Python/f1_ml_project/data/raw/lap_data.csv
2025-05-05 12:03:58,756 - DatasetBuilder - INFO - Loaded 143634 rows from lap data.
2025-05-05 12:03:58,756 - DatasetBuilder - INFO - Loading session data from /Users/brendan/Python/f1_ml_project/data/raw/session_raw.csv
2025-05-05 12:03:58,757 - DatasetBuilder - INFO - Loaded 265 rows from session data.
2025-05-05 12:03:58,757 - DatasetBuilder - INFO - Loading weather data from /Users/brendan/Python/f1_ml_project/data/raw/weather_raw.csv
2025-05-05 12:03:58,758 - DatasetBuilder - INFO - Loaded 529 rows from weather data.
2025-05-05 12:03:58,758 - DatasetBuilder - INFO - Loading Ergast results data from /Users/brendan/Python/f1_ml_project/data/raw/ergast_race_results.csv
2025-05-05 12:03:58,759 - DatasetBuilder - INFO - Loaded 879 rows from Ergast results data.
2025-05-05 12:03:58,759 - DatasetBuilder - INFO - Starting data merging...
2025-05-05 12:03:58,760 - DatasetBuilder - WARNING - Using 'date' column from session data as 'date_start' is missing.
2025-05-05 12:03:58,760 - DatasetBuilder - INFO - Extracting 'year' from 'date' in session_data.
2025-05-05 12:03:58,765 - DatasetBuilder - WARNING - Column 'circuit_short_name' missing in session_data. Adding placeholder based on country.
2025-05-05 12:03:58,766 - DatasetBuilder - INFO - Merging lap_data with session_data on 'session_key'...
2025-05-05 12:03:58,794 - DatasetBuilder - INFO - Rows after merging laps and sessions: 143634
2025-05-05 12:03:58,794 - DatasetBuilder - ERROR - CRITICAL: 'meeting_key' was lost during lap/session merge!
2025-05-05 12:03:58,794 - DatasetBuilder - INFO - Attempting to re-merge meeting_key...
2025-05-05 12:03:58,836 - DatasetBuilder - INFO - Merging with weather_data on 'meeting_key'...
2025-05-05 12:03:58,979 - DatasetBuilder - INFO - Rows after merging with weather: 143634
2025-05-05 12:03:58,979 - DatasetBuilder - INFO - Preparing to merge with Ergast race results...
2025-05-05 12:03:58,983 - DatasetBuilder - INFO - Fetching Ergast schedules for years: [2023 2024 2025]
2025-05-05 12:03:58,983 - DatasetBuilder - DEBUG - Fetching Ergast schedule for 2023 from http://ergast.com/api/f1/2023.json
2025-05-05 12:03:59,980 - DatasetBuilder - DEBUG - Fetched 22 schedule entries for 2023.
2025-05-05 12:04:00,183 - DatasetBuilder - DEBUG - Fetching Ergast schedule for 2024 from http://ergast.com/api/f1/2024.json
2025-05-05 12:04:01,085 - DatasetBuilder - DEBUG - Fetched 24 schedule entries for 2024.
2025-05-05 12:04:01,288 - DatasetBuilder - DEBUG - Fetching Ergast schedule for 2025 from http://ergast.com/api/f1/2025.json
2025-05-05 12:04:01,905 - DatasetBuilder - DEBUG - Fetched 0 schedule entries for 2025.
2025-05-05 12:04:02,110 - DatasetBuilder - WARNING - Attempting to merge schedule using 'circuit_short_name' as 'circuit_id'. This might be inaccurate.
2025-05-05 12:04:02,180 - DatasetBuilder - WARNING - 143634 rows could not be mapped to an Ergast round based on year/circuit_short_name.
2025-05-05 12:04:02,181 - DatasetBuilder - INFO - Merging main data with Ergast results on year, round, driver_number...
2025-05-05 12:04:02,241 - DatasetBuilder - INFO - Rows after merging with Ergast results: 143634
2025-05-05 12:04:02,271 - DatasetBuilder - INFO - Inferred/updated 'session_type' from 'session_name'.
2025-05-05 12:04:02,271 - DatasetBuilder - INFO - Data merging complete.
2025-05-05 12:04:02,393 - DatasetBuilder - INFO - Added 'year' and 'race_weekend' columns.
2025-05-05 12:04:02,393 - DatasetBuilder - INFO - Adding rolling lap time features with window size 3...
2025-05-05 12:04:02,424 - DatasetBuilder - INFO - Calculated rolling_avg_lap_time_3. Filled NaNs with 96.388.
2025-05-05 12:04:02,428 - DatasetBuilder - INFO - Starting cleaning. Initial rows: 143634
2025-05-05 12:04:02,478 - DatasetBuilder - INFO - Inferring/updating 'session_type' from 'session_name' during cleaning.
2025-05-05 12:04:02,519 - DatasetBuilder - INFO - Rows after filtering session types (['practice', 'qualifying', 'race', 'sprint', 'sprint_qualifying']): 138430
2025-05-05 12:04:02,537 - DatasetBuilder - INFO - Filtered out 6971 rows with invalid lap_duration (<= 0). Rows remaining: 131459
2025-05-05 12:04:02,564 - DatasetBuilder - INFO - Filled NaN values using median/mean for numeric or default for others.
2025-05-05 12:04:02,594 - DatasetBuilder - WARNING - Still missing values after cleaning: 8
2025-05-05 12:04:02,594 - DatasetBuilder - WARNING - Columns with remaining NaNs:
date_start    8
dtype: int64
2025-05-05 12:04:02,594 - DatasetBuilder - INFO - Cleaning complete. Final rows: 131459
2025-05-05 12:04:02,594 - DatasetBuilder - INFO - Saving cleaned data to /Users/brendan/Python/f1_ml_project/data/processed/cleaned_f1_data.csv...
2025-05-05 12:04:04,245 - DatasetBuilder - INFO - Successfully saved 131459 rows to /Users/brendan/Python/f1_ml_project/data/processed/cleaned_f1_data.csv.
2025-05-05 12:04:04,245 - DatasetBuilder - INFO - Generating summary report to /Users/brendan/Python/f1_ml_project/data/processed/summary.txt...
2025-05-05 12:04:04,381 - DatasetBuilder - INFO - Summary report generated successfully.
2025-05-05 12:04:04,381 - DatasetBuilder - INFO - Dataset builder pipeline finished.
2025-05-05 12:04:04,448 - DataMenu - INFO - Script data_pipeline/dataset_builder.py finished successfully. RC: 0
2025-05-05 12:09:21,761 - MainMenu - INFO - User exited program.
